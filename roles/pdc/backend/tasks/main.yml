---
# Configuration for the pdc-updater backend consumer

- name: setup the pdc-updater copr repo
  copy: >
      src="ralph-pdc-updater-epel-7.repo"
      dest="/etc/yum.repos.d/ralph-pdc-updater-epel-7.repo"
      owner=root group=root mode=0644
  tags: pdc

- name: install needed packages
  yum: pkg={{ item }} state=present
  with_items:
  - pdc-updater
  tags: pdc

- name: copy database configuration
  template: >
    src={{ item }} dest=/etc/fedmsg.d/{{ item }}
    owner=fedmsg group=fedmsg mode=0600
  with_items:
  - pdcupdater.py
  notify: restart fedmsg-hub
  tags: pdc
