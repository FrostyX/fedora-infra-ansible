---

- name: install needed packages
  yum: pkg={{ item }} state=installed
  with_items:
  - glusterfs-server
  tags:
  - packages

- name: glusterd service
  service: name=glusterd state=started enabled=yes

- name: make the datadir
  file: dest={{ datadir }} owner={{ owner }} group={{ group }} state=directory
  notify:
  - restart glusterd

- name: make the datapath
  file: dest={{ datadir }}/{{ name }} owner={{ owner }} group={{ group }} state=directory
  notify:
  - restart glusterd

- name: copy over the server config
  template: src=server.config dest=/etc/glusterfs/glusterd.vol
  notify:
  - restart glusterd
  
