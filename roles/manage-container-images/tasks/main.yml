---
# tasks file for push-docker
#
- name: install necessary packages
  package:
    name: "{{item}}"
    state: present
  with_items:
    - skopeo
  tags:
  - manage-container-images

- name: ensure cert dir exists
  file:
    path: "{{cert_dest_dir}}"
    state: directory
  tags:
  - manage-container-images

- name: install docker client cert for registry
  copy:
    src: "{{cert_src}}"
    dest: "{{cert_dest_dir}}/client.cert"
    owner: root
    group: "{{ certs_group }}"
    mode: 0640
  tags:
  - manage-container-images

- name: install docker client key for registry
  copy:
    src: "{{key_src}}"
    dest: "{{cert_dest_dir}}/client.key"
    group: "{{ certs_group }}"
    mode: 0640
  tags:
  - manage-container-images
