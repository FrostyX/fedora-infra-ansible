---
# Tasks to set up fedmsg-gateway-slave

- name: install needed packages
  yum: pkg={{ item }} state=installed
  with_items:
  - fedmsg-gateway
  tags:
  - packages

- name: Drop endpoints.py and gateway.py from fedmsg
  file: name={{ item }} state=absent
  with_items:
  - /etc/fedmsg.d/endpoints.py
  - /etc/fedmsg.d/gateway.py

- name: install /etc/fedmsg.d/fedmsg-gateway-slave.py
  template: src={{ item.file }}
            dest={{ item.dest }}
            owner=root group=root mode=0644
  with_items:
  - { file: fedmsg-gateway-slave.py.j2, dest: /etc/fedmsg.d/fedmsg-gateway-slave.py }
