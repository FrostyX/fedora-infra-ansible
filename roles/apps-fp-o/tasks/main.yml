- name: Install that apps-fp-o rpm package
  yum: name=apps-fp-o state=present
  tags:
  - apps-fp-o

- name: Copy in the proxy config
  copy: >
    src=apps.fp.o.conf dest=/etc/httpd/conf.d/{{website}}/apps.fp.o.conf
    owner=root group=root mode=0644
  notify:
  - restart httpd
  tags:
  - apps-fp-o

- name: Copy in some global assets used around our apps
  synchronize: >
    src=global/ dest=/srv/web/apps-fp-o/global/
  tags:
  - apps-fp-o

- name: Make sure the correct setype is in place
  file: >
    dest=/srv/web/apps.fp.o/ state=directory
    owner=root group=root mode=0755
    setype=httpd_sys_content_t recurse=True
  tags:
  - apps-fp-o

- name: Copy in our app data yaml
  file: >
    src=apps.yaml dest=/usr/share/apps-fp-o/apps.yaml
    owner=root group=root mode=0644
  notify:
  - rebuild apps-fp-o html
  - rebuild apps-fp-o json
  - restart httpd
  tags:
  - apps-fp-o
