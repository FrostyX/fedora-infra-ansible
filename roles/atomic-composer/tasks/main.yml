---
# This role sets up the fedmsg-driven atomic ostree composer

- yum: name=fedmsg-atomic-composer state=present enablerepo=infrastructure-testing

- user: name=rpmostreecompose
        shell=/bin/bash
        groups="mock,fedmsg"
        generate_ssh_key=yes
  register: user

- authorized_key: user={{ user['name'] }}
                  key="{{ user['ssh_public_key'] }}"

- file: path=/srv/fedora-atomic/
        owner={{ user['name'] }} group={{ user['name'] }} mode=755 state=directory

- seboolean: name=rsync_client state=true persistent=true
