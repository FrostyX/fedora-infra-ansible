- name: ensure packages required for resultsdb_frontend are installed
  yum: name={{ item }} state=latest enablerepo={{ extra_enablerepos }}
  when: deployment_type == 'prod' or deployment_type == 'local'
  with_items:
    - resultsdb_frontend
    - mod_wsgi

- name: ensure packages required for resultsdb_frontend are installed (f22+)
  dnf: name={{ item }} state=latest enablerepo={{ extra_enablerepos }}
  with_items:
    - resultsdb_frontend
    - mod_wsgi
  when: ansible_distribution_major_version|int > 21 and ansible_cmdline.ostree is not defined

- name: generate resultsdb_frontend config
  template: src=settings.py.j2 dest=/etc/resultsdb_frontend/settings.py owner=root group=root mode=0644
  notify:
    - restart httpd

- name: generate resultsdb_frontend apache config
  template: src=resultsdb_frontend.conf.j2 dest=/etc/httpd/conf.d/resultsdb_frontend.conf owner=root group=root mode=0644
  notify:
    - restart httpd
