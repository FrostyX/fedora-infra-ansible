- name: ensure packages required for buildslave are installed
  action: yum name={{ item }} state=latest
  with_items:
    - buildbot-slave
    - git
    - rpmlint
    - koji
    - bodhi-client
    - python-virtualenv
    - gcc
    - libcurl-devel
    - rpm-build
    - pylint
    - python-pep8
    - moreutils

- name: add the buildslave user
  user: name=buildslave

- name: add ports for buildslaves (fedora)
  command: firewall-cmd --permanent {{ item }}
  when: is_fedora
  with_items:
    - --add-port={{ buildslave_port }}/tcp

- name: add ports for buildslaves (rhel)
  command: lokkit -p '{{ item }}:tcp'
  when: is_rhel
  with_items:
    - "{{ buildslave_port }}"

