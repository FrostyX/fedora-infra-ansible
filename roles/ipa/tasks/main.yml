---
# Configuration for IPA

- name: install needed packages
  yum: pkg={{ item }} state=present update_cache=yes
  with_items:
  - ipa-server
  - ipa-server-dns
  tags:
  - packages

- name: install IPA
  command: ipa-server-install
           --realm={{ipa_realm}}
           --domain={{ipa_realm}}
           --ds-password{{ipa_dm_password}}
           --admin-password={{ipa_admin_password}}
           --mkhomedir
           --no-ntp
           --unattended
           --no-ssh
           --no-sshd
           --setup-dns
           --log-file=/var/log/ipainstall.log
           creates=/etc/ipa/default.conf
  tags:
  - config
