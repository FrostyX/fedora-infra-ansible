- name: Copy job template to a temporary file
  template:
    src: {{roles_path}}/openshift-apps/{{app}}/templates/job.yml
    dest: /etc/openshift_apps/{{app}}/job-{{name}}.yml

- name: Start job
  shell: oc -n koschei apply -f /etc/openshift_apps/{{app}}/job-{{name}}.yml

- name: Wait for job to complete
  shell: oc -n koschei wait job/job-{{name}} --for condition=complete

- name: Delete job
  shell: oc -n koschei delete job/job-{{name}}
